based on yangsheng's initial work in his Lab 27/10/2014
